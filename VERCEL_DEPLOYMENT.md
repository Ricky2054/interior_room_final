# Vercel Deployment Guide

This guide will walk you through deploying your Room Redesign AI application to Vercel.

## Prerequisites

Before you begin, make sure you have:

1. A [GitHub](https://github.com) account
2. A [Vercel](https://vercel.com) account
3. Your Stability AI API key
4. Your Google OAuth credentials

## Step 1: Prepare Your Project

First, check if your application is ready for deployment:

```bash
npm run check-deployment
```

This will verify that all required files and environment variables are present and that the application builds successfully.

Then run the preparation script:

```bash
npm run prepare-vercel
```

This script will:
- Generate a secure NEXTAUTH_SECRET
- Create a .vercelignore file
- Check for required environment variables

## Step 2: Push Your Code to GitHub

1. Create a new GitHub repository
2. Initialize your local repository (if not already done):
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   ```
3. Add your GitHub repository as a remote:
   ```bash
   git remote add origin https://github.com/yourusername/your-repo-name.git
   ```
4. Push your code:
   ```bash
   git push -u origin main
   ```

## Step 3: Deploy to Vercel

1. Go to [Vercel](https://vercel.com) and sign in
2. Click "Add New" > "Project"
3. Import your GitHub repository
4. Configure the project:
   - Framework Preset: Next.js
   - Root Directory: ./
   - Build Command: npm run build
   - Output Directory: .next

> **Note:** This application uses Next.js App Router. Vercel automatically detects and configures the App Router settings, but if you encounter any issues, make sure the "Framework Preset" is set to "Next.js" and the "Output Directory" is set to ".next".

## Step 4: Set Environment Variables

In the Vercel project settings, add the following environment variables:

| Name | Value | Description |
|------|-------|-------------|
| `STABILITY_API_KEY` | `sk-...` | Your Stability AI API key |
| `NEXTAUTH_SECRET` | `generated-secret` | The secret generated by the prepare-vercel script |
| `GOOGLE_CLIENT_ID` | `your-client-id` | Your Google OAuth client ID |
| `GOOGLE_CLIENT_SECRET` | `your-client-secret` | Your Google OAuth client secret |

### Using the Vercel CLI (Alternative Method)

You can also use the Vercel CLI to set environment variables. This is especially useful if you have many variables to set.

Run the following command to generate Vercel CLI commands for your environment variables:

```bash
npm run generate-vercel-env
```

This script will:
1. Read your local `.env.local` and `.env.production` files
2. Generate Vercel CLI commands to add each environment variable
3. Display the values you should enter when prompted

Follow the instructions provided by the script to add your environment variables to Vercel.

## Step 5: Update Google OAuth Settings

In the Google Cloud Console:
1. Go to "APIs & Services" > "Credentials"
2. Edit your OAuth 2.0 Client ID
3. Add your Vercel deployment URL to:
   - Authorized JavaScript origins: `https://your-project.vercel.app`
   - Authorized redirect URIs: `https://your-project.vercel.app/api/auth/callback/google`

## Step 6: Deploy

Click "Deploy" in the Vercel dashboard. Your application will be built and deployed automatically.

## Step 7: Test Your Deployment

1. Once deployed, visit your Vercel URL
2. Test the following functionality:
   - Google Sign-In
   - Text-to-Image Generation
   - Image Transformation

### Automated Verification

You can use the provided verification script to automatically check if your deployment is working correctly:

```bash
npm run verify-deployment
```

This script will:
1. Prompt you to enter your Vercel deployment URL
2. Check if the main page is accessible
3. Verify that key API endpoints are working
4. Provide a summary of the verification results
5. Suggest next steps for manual verification

## Troubleshooting

If you encounter issues:

1. **Authentication Issues**:
   - Check that your Google OAuth credentials are correct
   - Verify that the redirect URIs are properly configured
   - Make sure NEXTAUTH_URL is set to your Vercel deployment URL

2. **API Issues**:
   - Check that your Stability API key is valid
   - Look at the browser console for error messages
   - Check the Vercel logs for server-side errors

3. **Deployment Issues**:
   - Check the Vercel build logs for errors
   - Make sure all required environment variables are set
   - Try rebuilding the deployment

## Updating Your Deployment

To update your deployment:

1. Make changes to your code locally
2. Commit your changes:
   ```bash
   git add .
   git commit -m "Your update message"
   ```
3. Push to GitHub:
   ```bash
   git push
   ```
4. Vercel will automatically redeploy your application

### Updating Environment Variables

If you need to update environment variables on your Vercel deployment, you can use the provided script:

```bash
npm run update-vercel-env
```

This script will:
1. Check if the Vercel CLI is installed and you are logged in
2. Prompt you to enter the name of the environment variable to update
3. Prompt you to enter the new value
4. Provide instructions on how to update the environment variable using the Vercel CLI
5. Remind you to redeploy your application after updating the environment variable 