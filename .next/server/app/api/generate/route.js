"use strict";(()=>{var e={};e.id=290,e.ids=[290],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},94966:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g});var o={};r.r(o),r.d(o,{POST:()=>l});var a=r(49303),n=r(88716),i=r(60670),s=r(87070),p=r(71270);let u={artistic:{data:{output_format:"jpeg"},media_type:"image/jpeg"},photorealistic:{data:{output_format:"webp"},media_type:"image/webp"}};async function l(e){if(console.log("Generate API route called"),!(0,p.r4)())return console.error("API key not set"),s.NextResponse.json({error:"STABILITY_API_KEY not set in environment variables"},{status:500});try{let t=await e.formData(),r=t.get("prompt"),o=t.get("feature")||"artistic";if(console.log(`Received prompt: "${r}", feature: "${o}"`),!r)return console.error("No prompt provided"),s.NextResponse.json({error:"Prompt is required"},{status:400});if(!u[o])return console.error(`Invalid feature: ${o}`),s.NextResponse.json({error:"Invalid feature selected"},{status:400});let a=u[o],n=a.data.output_format;console.log(`Using output format: ${n}`);let i=(0,p.ki)({prompt:r,output_format:n});console.log("Making request to Stability API...");let l=await fetch("https://api.stability.ai/v2beta/stable-image/generate/core",{method:"POST",headers:{Authorization:`Bearer ${process.env.STABILITY_API_KEY}`,Accept:"image/*"},body:i});if(console.log(`Stability API response status: ${l.status}`),!l.ok){let{error:e,status:t}=await (0,p.zG)(l);return console.error("Stability API error:",e),s.NextResponse.json({error:e},{status:t})}let c=await l.arrayBuffer();console.log(`Received image data of size: ${c.byteLength} bytes`);let d=(0,p.mD)(a.media_type);return new s.NextResponse(Buffer.from(c),{headers:{"Content-Type":a.media_type,"Content-Disposition":`inline; filename=generated_${o}.${d}`}})}catch(e){return console.error("Error generating image:",e),s.NextResponse.json({error:"Failed to generate image"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/generate/route",pathname:"/api/generate",filename:"route",bundlePath:"app/api/generate/route"},resolvedPagePath:"C:\\Users\\RICKY DEY\\OneDrive\\Desktop\\sorbo\\interior_room_final\\app\\api\\generate\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:m}=c,f="/api/generate/route";function v(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}},71270:(e,t,r)=>{function o(){return!!process.env.STABILITY_API_KEY||(console.error("STABILITY_API_KEY not set in environment variables"),!1)}async function a(e){let t;try{t=await e.json()}catch(r){try{t=await e.text()}catch(e){t="Unknown error"}}return{error:t,status:e.status}}function n(e){let t=new FormData;return Object.entries(e).forEach(([e,r])=>{null!=r&&t.append(e,String(r))}),t}function i(e,t,r="image"){return e.append(r,t,"image.jpg"),e}function s(e){return"image/jpeg"===e?"jpeg":"webp"}r.d(t,{E4:()=>i,ki:()=>n,mD:()=>s,r4:()=>o,zG:()=>a})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[276,972],()=>r(94966));module.exports=o})();