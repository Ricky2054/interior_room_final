"use strict";(()=>{var e={};e.id=710,e.ids=[710],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5320:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>c,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d});var r={};a.r(r),a.d(r,{POST:()=>m});var o=a(49303),i=a(88716),n=a(60670),s=a(87070),p=a(71270);let l={"color change":{url:"https://api.stability.ai/v2beta/stable-image/edit/search-and-recolor",data:{prompt:"Change the dominant colors of the image to be more vibrant and appealing",select_prompt:"main color",output_format:"jpeg"},media_type:"image/jpeg"},refresh:{url:"https://api.stability.ai/v2beta/stable-image/edit/search-and-replace",data:{prompt:"Refresh the design elements while preserving the layout and integrity of the scene",search_prompt:"furniture",output_format:"webp"},media_type:"image/webp"},maximize:{url:"https://api.stability.ai/v2beta/stable-image/edit/outpaint",data:{prompt:"Expand the image by intelligently outpainting contextually appropriate elements",left:200,down:200,output_format:"webp"},media_type:"image/webp"},redesign:{url:"https://api.stability.ai/v2beta/stable-image/control/sketch",data:{prompt:"Redesign the room with a creative layout and innovative perspective",control_strength:.8,output_format:"webp"},media_type:"image/webp"},"functional change":{url:"https://api.stability.ai/v2beta/stable-image/control/style",data:{prompt:"Transform the room's function into a new theme while keeping its structure intact",output_format:"webp"},media_type:"image/webp"},"style stealer":{url:"https://api.stability.ai/v2beta/stable-image/control/style",data:{prompt:"Apply a distinctive artistic style to the room based on the original design",output_format:"webp"},media_type:"image/webp"},"image quality enhancer":{url:"https://api.stability.ai/v2beta/stable-image/upscale/fast",data:{prompt:"Enhance the image's resolution and clarity, making details crisper",output_format:"webp"},media_type:"image/webp"}};async function m(e){if(console.log("Transform API route called"),!(0,p.r4)())return console.error("API key not set"),s.NextResponse.json({error:"STABILITY_API_KEY not set in environment variables"},{status:500});try{let t=await e.formData(),a=t.get("image"),r=t.get("feature"),o=t.get("extra_prompt");if(console.log(`Received feature: "${r}", image: ${a?.name||"none"}, extra prompt: ${o||"none"}`),!a||!r)return console.error("Missing image or feature"),s.NextResponse.json({error:"Image and feature are required"},{status:400});if(!l[r])return console.error(`Invalid feature: ${r}`),s.NextResponse.json({error:"Invalid feature selected"},{status:400});let i=l[r],n=i.url;console.log(`Using URL: ${n}`);let m={...i.data};if(o){let e=m.prompt||"";m.prompt=`${e}. Additional details: ${o}`,console.log(`Modified prompt: ${m.prompt}`)}let u=await a.arrayBuffer(),c=Buffer.from(u),d=new Blob([c],{type:a.type});console.log(`Image size: ${c.length} bytes, type: ${a.type}`);let g=(0,p.ki)(m);(0,p.E4)(g,d),console.log("Making request to Stability API...");let f=await fetch(n,{method:"POST",headers:{Authorization:`Bearer ${process.env.STABILITY_API_KEY}`,Accept:"image/*"},body:g});if(console.log(`Stability API response status: ${f.status}`),!f.ok){let{error:e,status:t}=await (0,p.zG)(f);return console.error("Stability API error:",e),s.NextResponse.json({error:e},{status:t})}let h=await f.arrayBuffer();console.log(`Received image data of size: ${h.byteLength} bytes`);let b=(0,p.mD)(i.media_type);return new s.NextResponse(Buffer.from(h),{headers:{"Content-Type":i.media_type,"Content-Disposition":`inline; filename=generated_${r.replace(" ","_")}.${b}`}})}catch(e){return console.error("Error processing image transformation:",e),s.NextResponse.json({error:"Failed to process image transformation"},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/transform/route",pathname:"/api/transform",filename:"route",bundlePath:"app/api/transform/route"},resolvedPagePath:"C:\\Users\\RICKY DEY\\OneDrive\\Desktop\\sorbo\\interior_room_final\\app\\api\\transform\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:g}=u,f="/api/transform/route";function h(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}},71270:(e,t,a)=>{function r(){return!!process.env.STABILITY_API_KEY||(console.error("STABILITY_API_KEY not set in environment variables"),!1)}async function o(e){let t;try{t=await e.json()}catch(a){try{t=await e.text()}catch(e){t="Unknown error"}}return{error:t,status:e.status}}function i(e){let t=new FormData;return Object.entries(e).forEach(([e,a])=>{null!=a&&t.append(e,String(a))}),t}function n(e,t,a="image"){return e.append(a,t,"image.jpg"),e}function s(e){return"image/jpeg"===e?"jpeg":"webp"}a.d(t,{E4:()=>n,ki:()=>i,mD:()=>s,r4:()=>r,zG:()=>o})}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,972],()=>a(5320));module.exports=r})();